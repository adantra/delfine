\chapter{Formulação Matemática}
\label{ch:form_mat}

Neste trabalho, foi adotada a formulação matemática clássica proposta em \cite{Peaceman1977} para o escoamento simultâneo de duas fases imiscíveis em um meio poroso saturado. Esta abordagem vem sendo utilizada por muitos pesquisadores \citep{Ewing1983,Chavent1986,Carvalho2005,Silva2008} e tem com uma de suas principais características a manipulação da equação de conservação da massa usando a lei de Darcy de modo a formar um sistema com uma equação de pressão parabólica-elíptica e uma equação de saturação parabólica-hiperbólica \citep{Carvalho2005}, em oposição a outras formulações nas quais os campos de pressão e saturação são resolvidos simultaneamente em um sistema de \ac{EDP}s parabólicas \citep{Aziz1979}.
% [1] Describe briefly Aziz's formulation in the thesis, for comparison purposes

A formulação segregada de Peaceman permite o uso de métodos especializados capazes de explorar as particularidades matemáticas de cada equação do sistema resultante. O acoplamento entre estes dois campos é obtido através do uso de um termo de velocidade total.

De modo a utilizar as equações apresentadas ao longo deste capítulo, faz-se necessário a adoção de algumas hipóteses simplificadoras \citep{Carvalho2005,Peaceman1977}:
\begin{itemize}
\item Meio poroso saturado;
\item Rochas e fluidos incompressíveis;
\item Fluidos imiscíveis;
\item Escoamento isotérmico;
\item Lei de Darcy válida para as velocidades consideradas.
\end{itemize}

Para o correto entendimento da formulação adotada é necessário introduzir alguns conceitos, os quais serão discutidos na seção seguinte, usados para a descrição macroscópica das propriedades de rochas, fluidos e da interação entre os mesmos.

\section{Propriedades} \label{sc:propriedades}
Antes de iniciar a descrição das diversas propriedades necessárias para a elaboração do modelo matemático utilizado, é importante fazer um comentário a respeito do modo como essas propriedades se apresentam na realidade e como são de fato representadas na simulação do fenômeno no domínio de interesse.

Para uma perfeita descrição do escoamento de fluidos em meios porosos, seria necessário adotar uma abordagem microscópica, a qual necessitaria do conhecimento das características geométricas de cada um dos poros para a definição das fronteiras e das condições de contorno. De posse dessas informações, seria possível utilizar uma formulação matemática, como as equações de Navier-Stokes \citep{Fortuna2000}, acrescida de modelos geomecânicos e geoquímicos para simular o escoamento de cada um dos fluidos existentes no meio e a interação entre eles. Desnecessário comentar que tal alternativa é impraticável tanto do ponto de vista computacional, já que seria possível analisar domínios apenas em escalas cuja ordem de grandeza esteja na escala dos poros, quanto do ponto de vista da aquisição de dados de entrada, pois é praticamente impossível se obter toda a descrição morfológica de um meio como um reservatório de petróleo, do qual se obtém normalmente apenas algumas amostras, chamadas de testemunhos, os quais são retiradas de pontos que estão várias centenas de metros ou até quilômetros de distância entre si \citep{Thomas2001}.

Sendo assim, para todos os efeitos práticos, na análise numérica de reservatórios de petróleo se utiliza uma abordagem macroscópica, onde as propriedades são normalmente consideradas variáveis contínuas definidas em todo o domínio ocupado pelo meio poroso. Tais valores das grandezas físicas representam para cada ponto específico uma média volumétrica dos valores da região circunvizinha a este ponto. Ou seja, não é mais necessário uma descrição da morfologia exata do reservatório, já que ao invés disso serão utilizadas propriedades não mensuráveis no nível microscópico, mas que representam no nível macroscópico o efeito equivalente ao da estrutura do meio poroso \citep{Hurtado2005}.

Entretanto, é válido comentar que esta descrição macroscópica do meio poroso apresenta também dificuldades. As formações rochosas que formam os reservatórios de petróleo são frequentemente descritas através de modelos geológicos e geofísicos na escala de metros ou até menor \citep{Aarnes2007}. Tal escala tornaria em muitos casos inviável a simulação de escoamentos de fluidos em tais reservatórios, já que eles têm ordem de grandeza de quilômetros, o que implicaria, para casos tridimensionais, em malhas com vários milhões de elementos, passíveis de serem analisadas apenas em \emph{clusters} de grande porte.

Apesar do grande aumento na capacidade computacional do \emph{hardware} disponível e também do uso de técnicas avançadas para extrair o máximo de desempenho de tais computadores, os modelos de reservatório a serem analisados na prática frequentemente têm que contar com o uso de técnicas de \emph{Upscaling} \citep{Menezes2009}, ou seja, uma restrição dos parâmetros geofísicos obtidos em modelos geológicos para malhas tipicamente dezenas ou centenas de vezes menos refinadas que serão então analisadas via algum método numérico \citep{Aarnes2007}.

\subsection{Porosidade}
Uma rocha, para ter a capacidade de armazenar um fluido, por exemplo petróleo, deve possuir vazios no seu interior, os quais são chamados de poros. Além disso, para que haja fluxo dentro desta rocha-reservatório é necessário que tais poros estejam interconectados para que existam caminhos que os fluidos possam percorrer. Para efeitos de cálculo de porosidade, existe uma diferença entre a porosidade \emph{absoluta}, a qual abrange todos os poros, estejam eles interconectados ou não, e a porosidade \emph{efetiva}, onde apenas os poros ligados entre si são considerados. Apenas esse segundo tipo de porosidade será usado neste trabalho, já que é o de maior interesse para a análise de escoamentos. Portanto, sempre que houver referência à porosidade, pode-se entender como a variante efetiva da mesma.

A porosidade de uma rocha-reservatório é definida matematicamente como a razão entre o volume dos espaços vazios existentes na rocha e o volume total da amostra \citep{Thomas2001}. Logo, podemos descrever a porosidade $\phi$%
\nomenclature[a1phi]{$\phi$}{Porosidade efetiva}
como:

\begin{equation} \label{eq:porosidade}
\phi = \frac{V_{p}}{V_{t}}
\end{equation}%
\nomenclature[av]{$V$}{Volume}%

onde o volume total é $V_{t} = V_{p} + V_{s}$, com $V_{p}$ o volume poroso e $V_{s}$ o volume da matriz sólida. Segundo a abordagem macroscópica adotada, a porosidade será uma função contínua no espaço. Logo, se está assumindo que o valor calculado pela Eq. (\ref{eq:porosidade}) representará a média de um volume representativo com dimensão pequena quando comparada ao meio poroso como um todo, porém grande em comparação com as dimensões características dos poros.

A Fig. \ref{fig:meioporoso} apresenta esquematicamente uma amostra de meio poroso, com uma aproximação em uma parte dela onde se pode observar claramente os conceitos de volume poroso e de matriz sólida representados. A caracterização das fases em um escoamento bifásico é vista na Fig. \ref{fig:meioporososat}.

\begin{figure} 
\centering
\includegraphics[width=0.8\textwidth]{chapters/ch02/MeioPoroso}
\caption{Exemplo de meio poroso com destaque para os volumes de matriz sólida (rocha) e de poros (vazio).}
\label{fig:meioporoso}
\end{figure}

\begin{figure} 
\centering
\includegraphics[width=0.8\textwidth]{chapters/ch02/MeioPorosoSaturado}
\caption{Exemplo de meio poroso saturado com escoamento bifásico.}
\label{fig:meioporososat}
\end{figure}

\subsection{Permeabilidade Absoluta}
A permeabilidade absoluta é definida como uma medida da capacidade de uma única fase escoar em um meio poroso sob certas condições. Esta é uma propriedade mais difícil de ser medida do que a porosidade, porém mais importante no que tange ao escoamento de fluidos. Não necessariamente irá existir uma proporcionalidade direta entre estes dois parâmetros, já que para a permeabilidade importa não apenas a quantidade de poros interconectados, mas também o modo como eles estão conectados e a tortuosidade do caminho formado por eles. Existe também a possibilidade de se ter rochas com baixíssimas porosidades, como muitas vezes é o caso de algumas rochas carbonáticas, que porém apresentam uma alta permeabilidade devido à presença de fraturas ou falhas. Todavia, normalmente são geradas correlações entre as duas propriedades, como pode ser visto na Fig. \ref{fig:poropermcorrelation} \citep{Schneider2003}.

Normalmente, a permeabilidade é representada matematicamente através de um tensor de 2ª ordem, denominado de $\mathbi{K}$%
\nomenclature[cp]{$\mathbi{K}$}{Permeabilidade absoluta}
ao longo deste trabalho. Isto significa que não apenas os valores da permeabilidade absoluta variam de acordo com a orientação da rocha, como também que, devido aos termos cruzados de um ``tensor cheio'', os valores em uma direção influenciam a permeabilidade nas outras direções. Neste caso o tensor é chamado de anisotrópico. Se $\mathbi{K}$ puder ser representado por uma função escalar, ou seja, a permeabilidade em todas as direções for a mesma, este tensor degenerado em um escalar é chamado de isotrópico. Além disso, devido a grande heterogeneidade entre as diferentes formações rochosas, a permeabilidade pode variar espacialmente em ordens de grandeza, sendo que variações locais no intervalo entre 1mD e 10D não são incomuns \citep{Aarnes2007}.

O sistema elaborado neste trabalho pode lidar de modo efetivo tanto com tensores cheios (anisotropia), quanto com variações do mesmo ao longo do domínio (heterogeneidade).

\begin{figure} 
\centering
\includegraphics[width=0.6\textwidth, angle=270]{chapters/ch02/PorosityPermModel}
\caption{Exemplo de correlação entre porosidade e permeabilidade absoluta (retirado de \cite{Schneider2003}).}
\label{fig:poropermcorrelation}
\end{figure}

\subsection{Permeabilidade Relativa}
Apesar de termos assumido total imiscibilidade entre as fases, consideramos para efeitos de simulação, segundo a abordagem macroscópica adotada neste trabalho, a presença de todas as fases simultaneamente no mesmo ponto, já que, como mencionado anteriormente na seção \ref{sc:propriedades}, o comportamento do escoamento na escala dos poros não é de interesse prático para a análise de reservatórios. Isto significa que todas as fases terão influência umas sobre as outras.

Portanto, a permeabilidade de fato percebida por um fluido em um meio poroso será reduzida pela presença das outras fases, resultando, portanto, na necessidade da definição de um termo de permeabilidade relativa da fase $\alpha$, representado neste trabalho por $k_{r\alpha}$, que irá descrever como uma fase $\alpha$%
\nomenclature[d1a]{$\alpha$}{Relativo à fase $\alpha$ ($\alpha$=$w$ para água e $\alpha$=$o$ para óleo)}%
\nomenclature[dw]{$w$}{Relativo à fase água}%
\nomenclature[do]{$o$}{Relativo à fase óleo}
escoa na presença simultânea de outras.
As permeabilidades absoluta $\mathbi{K}$, efetiva $\mathbi{K}_{\alpha}$ e relativa $k_{r\alpha}$%
\nomenclature[ak]{$k_{r}$}{Permeabilidade relativa}
estão relacionadas através da seguinte expressão:
\begin{equation} \label{eq:relat_perm}
\mathbi{K}_{\alpha} = k_{r\alpha} \mathbi{K}
\end{equation}

Dada a complexidade envolvida na interação entre a rocha e as diferentes fases na escala dos poros durante o escoamento, os valores para a permeabilidade relativa em função das propriedades dos fluidos e dos meios porosos são difíceis de serem obtidos. De um modo geral, depende-se de modelos semi-empíricos para uso em simulações de reservatórios de petróleo.

Um exemplo típico de curva de permeabilidade relativa tanto da fase água quanto da fase óleo em função da saturação da água normalizada ($S_{wn}$) é obtido usando o modelo de Corey \citep{Chen2006, Carvalho2005, Silva2008}, o qual foi utilizado neste trabalho. A saturação normalizada pode ser definida utilizando os valores das saturações irredutíveis de água ($S_{wir}$) e residual de óleo ($S_{orw}$). $S_{wi}$ representa a menor saturação possível para a fase água em um processo mecânico, já $S_{orw}$ representa a menor saturação da fase óleo depois do varrido pela fase água. Uma representação gráfica da saturação normalizada pode ser vista na Fig. \ref{fig:swnorm} e a expressão para o cálculo da mesma é mostrada a seguir:

\begin{equation} \label{eq:normsat}
S_{wn}(S_{w}) = \frac{S_{w} - S_{wir}}{1 - S_{wir} - S_{orw}}
\end{equation}

\begin{figure}
\centering
\includegraphics[width=0.5\textwidth]{chapters/ch02/swnorm}
\caption{Saturação normalizada.}
\label{fig:swnorm}
\end{figure}

Uma vez obtido o valor para a saturação normalizada, as permeabilidade relativas para as fases são calculadas de acordo com a expressão a seguir. Um exemplo do uso do modelo de Corey para o cálculo das permeabilidades relativas é apresentado na Fig. \ref{fig:relat_perm}, onde $k_{rw}^{o}$ representa o valor máximo da permeabilidade relativa da água.

\begin{subequations} \label{eq:coreymodel}
\begin{equation} \label{eq:coreymodela}
k_{rw}(S_{wn}) = k_{rw}^{o}S_{wn}^{n_{w}}
\end{equation}
\begin{equation} \label{eq:coreymodelb}
k_{row}(S_{wn}) = \left(1 - S_{wn}\right)^{n_{w}}
\end{equation}
\end{subequations}

\begin{figure} 
\centering
\includegraphics[width=0.7\textwidth]{chapters/ch02/relat_perm}
\caption{Exemplo de modelo de permeabilidade relativa para escoamentos bifásicos em meios porosos.}
\label{fig:relat_perm}
\end{figure}

\section{Equação da Conservação de Massa}

Considerando a hipótese de meio poroso totalmente saturado e a existência de $n$ fases, a equação constitutiva para a saturação pode ser descrita por:
\begin{equation} \label{eq:eq_const_sat}
\sum_{\alpha=1}^n S_{\alpha} = 1
\end{equation}%
\nomenclature[as]{$S$}{Saturação}%
\nomenclature[an]{$n$}{Quantidade total de fases}%
onde $\alpha$ representa cada fase (neste trabalho, $\alpha = w$ e $o$ para água e óleo, respectivamente) e $S_{\alpha}$ representa a saturação da fase ${\alpha}$.

A lei de Darcy generalizada para a velocidade de cada fase é expressa através da seguinte equação:
\begin{equation} \label{eq:eq_darcy_general}
\mathbi{v}_{\alpha} = - \frac{\mathbi{K}_{\alpha}}{\mu_{\alpha}} \left(\nabla p_{\alpha} - \rho_{\alpha}g\nabla z \right)
\end{equation}%
\nomenclature[bv]{$\mathbi{v}$}{Velocidade}%
\nomenclature[a1mu]{$\mu$}{Viscosidade}%
\nomenclature[apr]{$p$}{Pressão}%
\nomenclature[a1rho]{$\rho$}{Densidade}%
\nomenclature[agr]{$g$}{Aceleração da gravidade}%
com $K_{\alpha}$, $\mu_{\alpha}$, $p_{\alpha}$ e $\rho_{\alpha}$ representando a permeabilidade efetiva, viscosidade, pressão e densidade da fase $\alpha$, ao passo que $g$ e $z$ representam a aceleração da gravidade e o deslocamento na direção da mesma, respectivamente.
% [4] Explain better Darcies experiment and how it led to the Darcy's law. Explain also its limitation and how it has been used nowadays far beyond its original intent.

A equação de conservação para cada fase é descrita como em \cite{Peaceman1977}:
\begin{equation} \label{eq:cons_eq}
-\nabla \cdot \left(\rho_{\alpha} \mathbi{v}_{\alpha}\right) + q_{\alpha} =
\frac{\partial \left(\phi \rho_{\alpha} S_{\alpha}\right)}{\partial t} 
\end{equation}
\nomenclature[aqf]{$q$}{Termo fonte/sumidouro}%
\nomenclature[ate]{$t$}{Tempo}%
Os termos $q_{\alpha}$, $\phi$ e $t$ representam termos fontes/sumidores da fase $\alpha$ (por exemplo, poços), porosidade efetiva da rocha e o tempo, respectivamente. Além disso, se forem consideradas duas fases, uma molhante (água) e uma não-molhante (óleo), combinando as Eqs. (\ref{eq:eq_darcy_general}) e (\ref{eq:cons_eq}), e usando a definição dada na Eq. (\ref{eq:relat_perm}), é obtido o seguinte sistema de equações diferenciais parciais que resolve o problema do escoamento bifásico dadas as hipóteses já mencionadas:
\begin{subequations} \label{eq:twophase_system}
  \begin{equation} \label{eq:twophase_systema}
\nabla \cdot \left(\frac{\rho_{w}\mathbi{K}k_{rw}}{\mu_{w}} \nabla\left(p_{w} - \rho_{w}g\nabla z \right)\right) + q_{w} =
\frac{\partial \left(\phi \rho_{w} S_{w}\right)}{\partial t} 
  \end{equation}
  \begin{equation} \label{eq:twophase_systemb}
\nabla \cdot \left(\frac{\rho_{o}\mathbi{K}k_{ro}}{\mu_{o}} \nabla\left(p_{o} - \rho_{o}g\nabla z \right)\right) + q_{o} =
\frac{\partial \left(\phi \rho_{o} S_{o}\right)}{\partial t} 
  \end{equation}
\end{subequations}
% [5] Stress that these equations are more general then the ones necessary for our assumptions and that they will be simplified

Nas Eqs. (\ref{eq:twophase_systema}) e (\ref{eq:twophase_systemb}), os campos de pressão e saturação são acoplados em ambas as equações. As mesmas se assemelham à equação de condução de calor e por isso espera-se que tenham um comportamento essencialmente parabólico. Esta assertiva não é necessariamente verdadeira e pode ser avaliada através da obtenção de um par de equações que seja dependente ou da pressão ou da saturação. A derivação de tais equações é apresentada na seção seguinte.

\section{Equação da Pressão} \label{sc:press_eq}
A abordagem utilizada para se obter a equação da pressão é eliminar a derivada temporal da saturação apresentada na Eq. (\ref{eq:twophase_system}). Primeiramente, as derivadas temporais são expandidas para se obter:
\begin{subequations} \label{eq:twophase_system2}
  \begin{equation} \label{eq:twophase_system2a}
-\nabla \cdot \left(\rho_{w} \mathbi{v}_{w}\right) + q_{w} =
\rho_{w}S_{w}\frac{\partial \phi}{\partial t} + \phi S_{w} \frac{d\rho_{w}}{d p_{w}} \frac{\partial p_{w}}{\partial t} + \phi\rho_{w}\frac{\partial S_{w}}{\partial t}
  \end{equation}
  \begin{equation} \label{eq:twophase_system2b}
-\nabla \cdot \left(\rho_{o} \mathbi{v}_{o}\right) + q_{o} =
\rho_{o}S_{o}\frac{\partial \phi}{\partial t} + \phi S_{o} \frac{d\rho_{o}}{d p_{o}} \frac{\partial p_{o}}{\partial t} + \phi\rho_{o}\frac{\partial S_{o}}{\partial t}
  \end{equation}
\end{subequations}

Então, dividindo a primeira equação por $\rho_{w}$, a segunda por $\rho_{o}$ e levando ainda em consideração as hipóteses feitas anteriormente de que fluidos e rochas são incompressíveis e finalmente adicionando as equações resultantes, obtêm-se:
% [6] This step mentioned in the previous paragraph can be explained in more 'substeps' in the thesis for clarity
\begin{equation} \label{eq:twophase_oneequation}
-\nabla \cdot \mathbi{v}_{t} + q_{t} = \phi \frac{\partial \left(S_{w} + S_{o}\right)}{\partial t}
\end{equation}
onde $\mathbi{v}_{t} = \mathbi{v}_{w} + \mathbi{v}_{o}$ é a velocidade total e $Q_{t} = (q_{w}/\rho_{w}) + (q_{o}/\rho_{o})$ é a taxa volumétrica total. Além disso, considerando a Eq. (\ref{eq:eq_const_sat}) e rearranjando os termos, nós obtemos a equação de pressão para o escoamento bifásico em meios porosos:
\begin{equation} \label{eq:pressure_eq_form1}
\nabla \cdot \mathbi{v}_{t} = Q_{t}
\end{equation}

De modo a apresentar a Eq. (\ref{eq:pressure_eq_form1}) em relação a apenas uma única variável de pressão, pode-se definir uma pressão média por:
\begin{equation} \label{eq:average_press}
p_{avg} = \frac{p_{w} + p_{o}} {2}
\end{equation}

Considerando a definição de pressão capilar como $p_{c} = p_{o} - p_{w}$, pode-se expressar as pressões das fases individuais como:
% [7] The capillary pressure must be better explained in the thesis, including some classical models for it
\begin{subequations} \label{eq:phase_pressures_cap}
  \begin{equation} \label{eq:phase_pressures_capa}
p_{w} = p_{avg} - \frac{p_{c}}{2}
  \end{equation}
  \begin{equation} \label{eq:phase_pressures_capb}
p_{o} = p_{avg} + \frac{p_{c}}{2}
  \end{equation}
\end{subequations}

As mobilidades das fases são definidas como a relação entre a permeabilidade relativa e a viscosidade do fluido:
\begin{equation} \label{eq:phase_mob}
\lambda_{\alpha} = \frac{k_{r\alpha}}{\mu_{\alpha}}
\end{equation}%
\nomenclature[a1lambda]{$\lambda$}{Mobilidade}%

Finalmente, reescrevendo a Eq. (\ref{eq:pressure_eq_form1}) utilizando pressões médias e capilares pode-se obter, depois de um rearranjo dos termos, a seguinte expressão:
\begin{equation} \label{eq:pressure_eq_form2}
\nabla \cdot \left(-\mathbi{K} \left( \left(\lambda_{w} + \lambda_{o} \right)\nabla p_{avg} + \frac{\lambda_{w} - \lambda_{o}}{2}\nabla p_{c} - 
\left(\lambda_{w}\rho_{w} + \lambda_{o}\rho_{o} \right)g\nabla z \right) \right) = Q_{t}
\end{equation}

Logo, pode ser observado que a Eq. (\ref{eq:pressure_eq_form2}), considerando as hipóteses feitas, tem uma natureza elíptica. Outrossim, foi considerada neste trabalho a hipótese de fluxo horizontal (sem influência da gravidade) e com pressão capilar negligenciável. Deste modo foi possível se concentrar nas características elípticas da equação de pressão. Definindo-se a mobilidade total como $\lambda_{t} = \lambda_{w} + \lambda_{o}$, a forma simplificada da equação de pressão pode ser apresentada como:
\begin{equation} \label{eq:pressure_eq_form3}
- \nabla \cdot \left(\mathbi{K} \lambda_{t} \nabla p_{avg} \right) = Q_{t}
\end{equation}

\section{Equação da Saturação}
\label{sc:eq_sat}
A equação de saturação pode ser deduzida usando uma manipulação algébrica similar à utilizada na seção anterior de modo a completar o modelo de pressão-saturação para um escoamento bifásico água-óleo em meios porosos. Para a derivação desta equação faz-se necessário definir qual das fases (molhante ou não-molhante) servirá de referência. Neste trabalho foi escolhida a fase água, sendo tal escolha absolutamente arbitrária, tendo apenas seguido a prática usual da literatura \citep{Peaceman1977, Ewing1983, Carvalho2005, Silva2008}.

Consideraremos a princípio que tenha sido obtida uma solução para um caso mais geral representado pela Eq. (\ref{eq:pressure_eq_form2}), sendo portanto conhecida $p_{avg}$. Logo, as pressões das fases água $(p_{w})$ e óleo $(p_{o})$ podem ser calculadas a partir da Eq. (\ref{eq:phase_pressures_cap}) e utilizando a Eq. (\ref{eq:eq_darcy_general}) podemos calcular as velocidades das duas fases, obtendo:
\begin{subequations} \label{eq:phase_velocities}
  \begin{equation} \label{eq:phase_velocitiesa}
\mathbi{v}_{w} = - \mathbi{K}\lambda_{w} \left(\nabla p_{w} - \rho_{w}g\nabla z \right)
  \end{equation}
  \begin{equation} \label{eq:phase_velocitiesb}
\mathbi{v}_{o} = - \mathbi{K}\lambda_{o} \left(\nabla p_{o} - \rho_{o}g\nabla z \right)
  \end{equation}
\end{subequations}

Multiplicando a Eq. (\ref{eq:phase_velocitiesa}) por $\lambda_{o}$, a Eq. (\ref{eq:phase_velocitiesb}) por $\lambda_{w}$, subtraindo uma da outra e utilizando a definição de pressão capilar, pode-se obter:
\begin{equation} \label{eq:phase_velocities2}
- \lambda_{w}\mathbi{v}_{o} + \lambda_{o}\mathbi{v}_{w} = \mathbi{K}\lambda_{o}\lambda_{w}\nabla p_{c} - \mathbi{K}\lambda_{o}\lambda_{w}\left(\rho_{o} - \rho_{w}\right)g\nabla z
\end{equation}

Considerando-se ainda as definições de velocidade e mobilidade total, podemos reescrever a equação anterior como:
\begin{equation} \label{eq:phase_velocities3}
\lambda_{t}\mathbi{v}_{w} = \lambda_{w}\mathbi{v}_{t} + \mathbi{K}\lambda_{o}\lambda_{w}\left(\nabla p_{c} + \left(\rho_{w} - \rho_{o}\right)g\nabla z\right)
\end{equation}

Definindo ainda o fluxo fracional da fase $\alpha$ como:
\begin{equation} \label{eq:fracflux}
f_{\alpha} = \frac{\lambda_{\alpha}}{\lambda_{t}}
\end{equation}%
\nomenclature[aff]{$f$}{Fluxo fracional}%
e utilizando-se a seguinte função da saturação para simplificar a notação:
\begin{equation} \label{eq:derivcapsat}
h_{w} = - \frac{\lambda_{o}\lambda_{w}}{\lambda_{t}} \frac{d p_{c}}{d S_{w}}
\end{equation}
podemos obter uma expressão na qual a velocidade da fase água é expressa em função da velocidade total. Substituindo as Eqs. (\ref{eq:fracflux}) e (\ref{eq:derivcapsat}) na Eq. (\ref{eq:phase_velocities3}) e inserindo esta na Eq. (\ref{eq:cons_eq}), podemos escrever a seguinte expressão para a saturação da fase água:
\begin{equation} \label{eq:sateq}
\frac{\partial (\phi\rho_{w}S_{w})}{\partial t} = - \nabla\cdot\left(\rho_{w}\left(f_{w}\mathbi{v}_{t} - \mathbi{K}h_{w}\nabla S_{w} + \mathbi{K}\lambda_{o}f_{w}\left(\rho_{w} - \rho_{o}\right)g\nabla z\right)\right) + q_{w}
\end{equation}

Assumindo as hipóteses já mencionadas de rochas e fluidos incompressíveis podemos representar a expressão anterior por:
\begin{equation} \label{eq:sateq2}
\phi\rho_{w}\frac{\partial S_{w}}{\partial t} = - \rho_{w}\nabla\cdot\left(\left(f_{w}\mathbi{v}_{t} - \mathbi{K}h_{w}\nabla S_{w} + \mathbi{K}\lambda_{o}f_{w}\left(\rho_{w} - \rho_{o}\right)g\nabla z\right)\right) + q_{w}
\end{equation}

Além disso, dividindo a Eq. \ref{eq:sateq2} por $\rho_{w}$ e considerando a definição do termo de taxa volumétrica de injeção/produção da fase água $Q_{w} = q_{w}/\rho_{w}$, obtemos:
\begin{equation} \label{eq:sateq3}
\phi\frac{\partial S_{w}}{\partial t} = - \nabla\cdot\left(\left(f_{w}\mathbi{v}_{t} - \mathbi{K}h_{w}\nabla S_{w} + \mathbi{K}\lambda_{o}f_{w}\left(\rho_{w} - \rho_{o}\right)g\nabla z\right)\right) + Q_{w}
\end{equation}


A Eq. (\ref{eq:sateq3}) permite obter a saturação da fase água em um meio poroso considerando as hipóteses básicas descritas no início deste capítulo. Esta equação apresenta um comportamento essencialmente parabólico-hiperbólico, a não ser que o termo de capilaridade seja desprezível comparado com os termos advectivos, o que é verdade especialmente para casos como na vizinhança de poços ou em áreas do reservatório onde a velocidade total seja alta \citep{Carvalho2005}. Considerando esta última conjectura como válida e supondo um escoamento horizontal, obtemos a forma simplificada para a saturação da fase água em um meio poroso:
\begin{equation} \label{eq:sateq4}
\phi\frac{\partial S_{w}}{\partial t} = - \nabla\cdot\left(f_{w}\mathbi{v}_{t}\right) + Q_{w}
\end{equation}

A Eq. (\ref{eq:sateq4}) apresenta características essencialmente hiperbólicas e não-lineares devido ao termo de fluxo fracional. Um modo de estudar os fenômenos principais associados a esta equação é utilizar modelos que isolem apenas algumas das características de interesse. Sendo assim, serão apresentadas a seguir duas variações das equações apresentadas para a saturação. A primeira delas considera um escoamento unidimensional e sem termo de fonte, onde o principal objetivo é analisar o efeito da não-linearidade decorrente do fluxo fracional. A segunda variação considera uma versão linear da Eq. (\ref{eq:sateq3}), a qual nada mais é do que a conhecida equação de difusão-convecção e que neste caso governa o escoamento multidimensional de fluidos miscíveis \citep{Peaceman1977, Barbosa2009, Loula1995}.

\subsection{Equação de Buckley-Leverett}
\label{sc:buckleyeq}
\cite{Buckley1942} propuseram um modelo para representar o deslocamento imiscível de óleo por água em meios porosos rígidos unidimensionais, considerando os termos de gravidade e capilaridade desprezíveis. Partindo da Eq. (\ref{eq:sateq4}), eliminamos o termo de fonte, já que neste modelo injeção e produção são manuseadas nas condições de contorno. Assim, para o caso unidimensional podemos obter:
\begin{equation} \label{eq:buclev1}
\phi\frac{\partial S_{w}}{\partial t} + \frac{\partial \left(f_{w}\mathbi{v}_{t}\right)}{\partial x}= 0
\end{equation}

Expandindo o segundo termo da Eq. (\ref{eq:buclev1}) utilizando a regra de derivada do produto, chegamos a:
\begin{equation} \label{eq:buclev2}
\phi\frac{\partial S_{w}}{\partial t} + \mathbi{v}_{t}\frac{\partial f_{w}}{\partial x} + f_{w}\frac{\partial \mathbi{v}_{t}}{\partial x}= 0
\end{equation}

Sendo que a derivada parcial do terceiro termo desta equação necessariamente tem que ser igual a zero se consideramos a imposição de continuidade dada pela Eq. (\ref{eq:pressure_eq_form1}) e utilizando um termo de fonte nulo. Além disso, podemos expandir o segundo termo usando a regra da cadeia, obtendo assim a equação de Buckley-Leverett:
\begin{equation} \label{eq:buclev3}
\phi\frac{\partial S_{w}}{\partial t} + \mathbi{v}_{t}\frac{d f_{w}}{d S_{w}}\frac{\partial S_{w}}{\partial x}= 0
\end{equation}

Esta é uma equação hiperbólica de transporte não-linear, pois o coeficiente que multiplica o termo $\partial S_{w}/\partial x$ é uma função não-linear de $S_{w}$ \citep{Carvalho2005}. A análise do comportamento desta função permite inferir um série de propriedades comuns aos escoamentos mais complexos. Um exemplo de representação da função de fluxo fracional e de sua derivada em relação à saturação pode ser observado na Fig. \ref{fig:fracflux}. No Capítulo \ref{ch:resultados} serão apresentados e discutidos resultados para esta equação modelo.
\begin{figure} 
\centering
\includegraphics[width=0.7\textwidth]{chapters/ch02/fracflux}
\caption{Exemplo de função de fluxo fracional e sua derivada relativa à saturação da fase água.}
\label{fig:fracflux}
\end{figure}

\subsection{Equação do Deslocamento de Fluidos Miscíveis}
\label{sc:miscibleeq}
A análise da equações de escoamentos miscíveis em meios porosos permite analisar o comportamento de diversos fenômenos de interesse como, por exemplo, o transporte de contaminantes em aquíferos \citep{Carvalho2005}, a injeção de traçadores em reservatórios de petróleo para recuperação avançada \citep{Loula1995}, entre outros \citep{Bear1992, Barbosa2009}. Na área de simulação de reservatórios tais equações têm sido tradicionalmente utilizadas para testar e desenvolver formulação numéricas devido as diversas similaridades existentes quando comparadas às equações que descrevem os escoamentos imiscíveis \citep{Ewing1983}.

A equação para a concentração $C$ do soluto (traçador) dissolvido em um fluido solvente é dada por:
\begin{equation} \label{eq:misc1}
\phi\frac{\partial C}{\partial t} = - \nabla\cdot\left(\mathbi{v}C - \mathbi{D}\nabla C \right) + \hat{C}Q
\end{equation}%
\nomenclature[acon]{$C$}{Concentração}%
onde $\mathbi{D}$%
\nomenclature[cdi]{$\mathbi{D}$}{Tensor de Dispersão-Difusão}
representa o tensor de dispersão-difusividade, $Q$ é o termo fonte/sumidouro nos poços e $\hat{C}$ é a concentração nos mesmos.

O tensor $\mathbi{D}$ combina os efeitos de dispersão mecânica e difusão molecular, onde o primeiro é normalmente proporcional à velocidade e possui componentes tanto na direção longitudinal quanto transversal do escoamento. Já o termo de difusão pode ser calculado pela Lei de Fick, a qual permite obter um fluxo difusivo a partir do gradiente de concentração do soluto $C$. Uma excelente discussão a respeito dos detalhes sobre este tensor e a interpretação física de seus componentes pode ser encontrado em \cite{Ewing1983}.

No Capítulo \ref{ch:form_num} a versão unidimensional em meio homogêneo da Eq. (\ref{eq:misc1}) será utilizada para a apresentação de alguns dos métodos numéricos utilizados neste trabalho.

\section{Condições Iniciais e de Contorno}
\label{sc:cond_ini_bc}
% Garcia / Chen / Shan / Comentarios Ewing
Antes de especificar a formulação numérica utilizada, algumas definições a respeito das condições iniciais, de contorno e hipóteses simplificadoras têm que ser discutidas para tornar o problema abordado completamente determinado.

Os contornos são descritos como $\Gamma = \partial \Omega$ $= \Gamma_{I} \cup$ $\Gamma_{P} \cup$ $\Gamma_{D} \cup$ $\Gamma_{N}$%
\nomenclature[e1g]{$\Gamma$}{Contorno do domínio $\Omega$}%
\nomenclature[e1o]{$\Omega$}{Domínio espacial do problema}
, onde \citep{Carvalho2005}:
% Talvez mudar a ordem passando a descricao acima para junto da parte de discretizacao,
% comecando portanto apenas com a parte referente a formulacao fraca 'analitica'
\begin{itemize}
\item $\Gamma_{I}$ = Poços injetores;
\item $\Gamma_{P}$ = Poços produtores;
\item $\Gamma_{D}$ = Condição de contorno de Dirichlet (Variável prescrita);
\item $\Gamma_{N}$ = Condição de contorno de Neumman (Fluxo prescrito).
\end{itemize}

Usualmente, os poços são tratados como condições de contorno internas, sendo modelados através de métodos especiais para lidar com a velocidade alta nas adjacências de um poço \citep{Peaceman1977} comparada com o resto do domínio. Apesar disso, foi adotada neste trabalho uma hipótese simplificadora, considerando que os poços são termos fonte/sumidouros de produção ou injeção concentrados em um único nó da malha, isto é, uma função delta de Dirac neste ponto.

Neste trabalho, foi feita a consideração usual adotada em problemas de reservatório de petróleo \citep{Peaceman1977, Ewing1983} de condição de fluxo zero em todas as fronteiras exteriores do domínio, isto é:
\begin{equation} \label{eq:noflowbc}
\mathbi{K} \lambda p \cdot \mathbi{n} = 0 \quad \textrm{em $\Gamma_{N}$}
\end{equation}
onde $\lambda$ é a mobibilidade total, ou seja, $\lambda = \lambda_{w} + \lambda_{o}$, $p$ é a pressão média ($p = p_{avg}$) e $\mathbi{n}$%
\nomenclature[bnv]{$\mathbi{n}$}{Vetor normal ao contorno}
 é o vetor unitário normal aos contornos externos.
 
Logo, assumindo que a transferência de massa entre o reservatório e o meio externo se dará apenas pelos poços injetores e produtores, temos:
\begin{equation} \label{eq:wellbc}
\left. \begin{array}{lll}
\mathbi{v}_{\alpha} \cdot \mathbi{n} = q^{I}_{\alpha} \quad \textrm{ou} \quad p(\mathbi{x},t) = p^{I} \quad \textrm{em $\Gamma_{I}$} \\
\mathbi{v}_{\alpha} \cdot \mathbi{n} = q^{P}_{\alpha} \quad \textrm{ou} \quad p(\mathbi{x},t) = p^{P} \quad \textrm{em $\Gamma_{P}$} \\
\end{array} \right.
\end{equation}
onde $q_{I}_{\alpha}$ e $q_{P}_{\alpha}$ representam as vazões volumétricas da fase $\alpha$ nos poços injetores e produtores, respectivamente.

As condições inicial e de contorno para a equação de saturação são:
\begin{equation} \label{eq:satinibc}
\left. \begin{array}{lll}
S_{w}(\mathbi{x},0) = S^{t=0}_{w} \quad \textrm{em $\Omega$} \\
S_{w}(\mathbi{x},t) = S^{I}_{w} \quad \textrm{em $\Gamma_{I}$} \\
\mathbi{K} \nabla S_{w}(\mathbi{x},t) \cdot \mathbi{n} = 0 \quad \textrm{em $\Gamma_{N}$}\\
\end{array} \right.
\end{equation}

Para a equação da concentração de um soluto em um fluido solvente, ver Eq. (\ref{eq:misc1}), as condições iniciais e de contorno são definidas de modo similar:
\begin{equation} \label{eq:coninibc}
\left. \begin{array}{lll}
C(\mathbi{x},0) = C^{t=0} \quad \textrm{em $\Omega$} \\
C(\mathbi{x},t) = \hat{C} \quad \textrm{em $\Gamma_{I}$} \\
\mathbi{D} \nabla C(\mathbi{x},t) \cdot \mathbi{n} = 0 \quad \textrm{em $\Gamma_{N}$}\\
\end{array} \right.
\end{equation}