\chapter{Introdução}
\label{ch:introduction}

\section{Motivação}
\label{sc:motivation}

Atualmente, a simulação numérica do escoamento de fluidos em meios porosos é fundamental em várias áreas da engenharia, como na análise de transporte de contaminantes em aquíferos \citep{Bear1992}, no gerenciamento de água e calor em membranas poliméricas para células de combustível \citep{Matamoros2006} ou para a simulação de escoamentos multifásicos em reservatórios de petróleo \citep{Peaceman1977, Aziz1979,Ewing1983,Carvalho2005,Silva2008}.

% Explicar o porque de se modelar reservatorios. Tipos de reservatorio, de explotacao, aumento no fator de recuperacao, etc. Boa parte desse assunto é discutida no livro do Thomas de modo geral, o que pode ser interessente neste capítulo inicial.
A modelagem científica do escoamento de fluidos em meios porosos para a indústria do petróleo vem sendo feita desde os anos 30 do século passado, inicialmente utilizando modelos de areia compactada para compreender o mecanismo da produção de água em reservatórios de petróleo e o porquê da proporção da água sobre o óleo aumentar  ao longo do tempo. No final dos anos 30 e começo dos 40 alguns experimentos com modelos eletrolíticos foram usados para representar o escoamento em meios porosos, tendo sido nesta época já reconhecida a analogia entre as leis que regem o fluxo de corrente elétrica e as leis de Darcy \citep{Peaceman1990}. Todos esses modelos físicos análogos permitiram a obtenção de um conhecimento mais profundo sobre os fenômenos que governam este tipo de problema, porém apenas com o advento dos computadores eletrônicos é que foi possível para os engenheiros simularem problemas de forma mais realista, como o de reservatórios de petróleo em 2 ou 3 dimensões.

Paralelamente ao desenvolvimento de novos \emph{hardwares}, houve também um trabalho extensivo em métodos computacionais aplicados ao escoamento multifásico em meios porosos. O primeiro método utilizado em larga escala para resolver \ac{EDP} numericamente, e ainda padrão na indústria do petróleo, foi o \ac{MDF} \citep{Peaceman1990}. Entretanto, este tipo de método apresenta certas desvantagens, como a dificuldade para lidar com domínios complexos, condições de contorno gerais e para incorporar adaptação local de malhas \citep{Chen2006}, especialmente quando comparado com métodos mais adequados para lidar com malhas não-estruturadas que vêm sendo aplicados mais recentemente nesta área como é o caso do \ac{MVF} \citep{Carvalho2005, Cordazzo2006} ou o \acf{MEF} \citep{Chen2006}. Por estes motivos, três métodos da última classe citada foram usados ao longo deste trabalho.

Um aspecto comum a todos estes métodos computacionais é o tempo considerável necessário para o desenvolvimento de programas de computador que implementem formulações para casos gerais ou complexos. Muito desse tempo é consumido codificando tarefas que são comuns a praticamente qualquer software de simulação numérica, como, por exemplo, a montagem das matrizes, manipulação de dados de entrada e saída (I/O) ou a solução iterativa de sistemas de equações lineares. A abordagem adotada neste trabalho para superar esta dificuldade foi utilizar a ferramenta de código aberto \emph{FEniCS/DOLFIN} \citep{Logg2010}, a qual permite efetuar a geração automática de código de baixo nível (em \emph{C++}) baseada em informações fornecidas através de uma interface com um programa escrito em código de alto nível (\emph{Python} ou \emph{C++}), permitindo ao programador se concentrar no desenvolvimento e teste de diferentes formulações matemáticas e numéricas para o problema de interesse usando uma sintaxe muito similar àquela encontrada na descrição matemática do problema, ao invés de despender tempo escrevendo códigos auxiliares para tarefas administrativas.

Além disso, existe uma necessidade de reduzir o tempo de CPU de um programa, de modo a viabilizar o uso de simulações dentro do prazo de um projeto. Normalmente, a parte que mais consome tempo de processamento em uma simulação é a solução numérica dos sistemas de equações lineares resultantes da discretização das \ac{EDP}s \citep{Saad2003}. Várias técnicas estão disponíveis para resolver de modo iterativo estes tipos de sistemas, cada uma delas com suas próprias vantagens e desvantagens em termos de velocidade e generalidade, sendo que estas características frequentemente apontam para direções distintas, isto é, um método extremamente rápido para uma classe de problemas muitas vezes não é geral e vice-versa. Neste trabalho foi utilizado um método conhecido por acoplar de modo quase ideal estas duas características: o método Multigrid \citep{Trottenberg2001, Saad2003, Briggs2000}. Todavia, esta particularidade não é obtida sem custo, neste caso, as principais dificuldades adicionais associadas aos métodos Multigrid são: a necessidade de uma sequência de malhas sucessivamente menos refinadas, cuja geração pode se tornar um problema caso não seja abordada adequadamente e o uso de operadores de transferência de informações entre níveis consecutivos. Seguindo o princípio de economizar tempo de codificação com tarefas gerais e manter o foco no problema de interesse, neste trabalho foi utilizada a biblioteca de código aberto \emph{PyAMG} \citep{Bell2008}, a qual não apenas efetua de modo completamente automático a geração de uma sequência de matrizes, dada uma malha inicial, como também permite o uso de diferentes variantes do Método do \ac{AMG}, incluindo os algoritmos clássicos de Ruge-St\"{u}ben e o de Agregação Suavizada (\emph{Smooth Aggregation}) \citep{Trottenberg2001}.

%\section{Histórico da Simulação de Reservatórios de Petróleo}
%\label{sc:histSimRes}

%\section{Histórico do Multigrid}
%\label{sc:histMult}

%\section{Histórico da Modelagem Automática de Equações Diferenciais}
%\label{sc:histMult}

\section{Objetivos}
\label{sc:obj}
Dada a relevância do problema proposto, como mencionado na seção \ref{sc:motivation}, o objetivo principal deste trabalho é o desenvolvimento de um sistema computacional para a simulação de escoamentos bifásicos óleo-água em meios porosos, considerando a flexibilidade de lidar com geometrias bidimensionais e tridimensionais, domínios homogêneos e heterogêneos e tensores de permeabilidades isotrópicos e anisotrópicos. Além disso, como objetivos secundários temos o uso de técnicas de alto desempenho (Método do \acf{AMG}) para diminuição do tempo necessário de processamento para as análises e a utilização de pacotes computacionais que permitem a automação de parte do processo de desenvolvimento do software.

Na literatura existem diversas opções disponíveis de métodos matemáticos, numéricos e computacionais para resolução dos problemas inerentes às metas pretendidas neste trabalho. Em relação à descrição matemática do problema, optou-se pela utilização da formulação clássica que considera a lei de Darcy para modelar o fenômeno de interesse. Esta formulação é razoável para uma certa classe de aplicações de interesse, porém possui limitações bastante discutidas na literatura já que a mesma foi originalmente desenvolvida para um contexto diferente (escoamento monofásico laminar em um tubo preenchido com areia). No capítulo \ref{ch:form_mat} serão discutidas as hipóteses que devem ser consideradas para manter a validade da formulação utilizada. Em todo caso, o modelo de Darcy é utilizado largamente na indústria e academia \citep{Peaceman1990, Aziz1979, Marle1981, Ewing1983}, tendo se mostrado adequado para o objetivo ao qual este trabalho se destina, desde que respeitadas as limitações impostas pelo mesmo.

Analisando as alternativas disponíveis em termos de métodos numéricos, optou-se pelo uso do \ac{MEF} pela sua combinação de sólida base teórica disponível na literatura \citep{Chavent1986, Chen2006, Hughes2000} e grande flexibilidade para lidar com casos que apresentem geometrias ou condições de contorno complexas. Como objetivos específicos dentro deste quesito, temos a discretização das \ac{EDP}s usando a formulação de Galerkin para a equação de pressão \citep{Luna2011} e o método \ac{SUPG} para a equação de saturação, estando as duas variáveis acopladas de modo sequencial implícito via velocidade total. Também foi testada a discretização via \ac{MEFM} para a pressão e velocidade simultaneamente, calculando a saturação posteriormente usando também o método \ac{SUPG}. Em relação à resolução do sistema de equações provenientes de tal discretização, foi definida como meta específica o uso de alguma técnica de aceleração de convergência que permitisse uma grande escalabilidade de modo a ser possível a simulação de problemas de grande porte. Para este fim, foi escolhido, dentre as opções disponíveis, o uso do método \ac{AMG} devido a sua robustez e eficiência.

Por fim, foi estabelecida a meta de elaborar um sistema computacional de modo prático e utilizando técnicas de geração de código automática, tendo assim um programa mais fácil de ser gerenciado e expandido conforme surjam novas necessidades. No capítulo \ref{ch:implementacao} serão discutidas as opções disponíveis na literatura e o porquê da escolha, dentre elas, da ferramenta \emph{FEniCS/DOLFIN}.

\section{Organização da Dissertação}
\label{sc:orgTrab}
Esta dissertação está dividida em seis capítulos, incluindo introdução e conclusão, organizados de modo a apresentar sequencialmente os passos necessários para se alcançar os objetivos definidos na seção \ref{sc:obj}. Além disso, um apêndice que lida com aspectos práticos da implementação e uso do código desenvolvido foi anexado ao final do trabalho.

\begin{itemize}
\item \emph{Capítulo 1: Introdução.} O presente capítulo contém a motivação para a realização deste trabalho, um curto histórico das principais áreas relacionadas com uma revisão bibliográfica de alguns dos principais trabalhos de outros autores e suas contribuições, e por fim uma apresentação clara dos objetivos do trabalho e a descrição da organização desta dissertação.
\item \emph{Capítulo 2: Formulação Matemática.} No segundo capítulo são apresentadas as equações governantes do problema que se deseja modelar. As propriedades de rocha, fluido e de interação rocha-fluido são descritas e a notação utilizada ao longo do trabalho é definida. Além disso, são discutidas as principais hipóteses simplificadoras utilizadas.
\item \emph{Capítulo 3: Formulação Numérica.} Lida com a transformação de um problema contínuo definido pelas equações apresentadas no capítulo \ref{ch:form_mat} em um problema discreto que pode ser resolvido de modo aproximado utilizando métodos numéricos, os quais também são discutidos em detalhes.
\item \emph{Capítulo 4: Implementação Computacional.} Neste capítulo são abordados os aspectos práticos relativos à implementação de todo o arcabouço teórico desenvolvido. Os principais programas e bibliotecas utilizados são apresentados e as razões para a escolha de cada um é discutida. Por fim, um algoritmo em diagramas de blocos da estrutura geral do programa é exposto, de onde se pode observar as interligações entre os diferentes pacotes adotados e os pontos de interface com o código escrito especificamente para este trabalho.
\item \emph{Capítulo 5: Resultados.} A flexibilidade e acurácia do programa desenvolvido é comprovada através do uso de diversos exemplos que variam desde casos simples homogêneos e isotrópicos com solução analítica, até casos mais complexos considerando heterogeneidades no domínio e o uso de tensores de permeabilidade anisotrópicos. Sempre que possível, as soluções obtidas foram comparadas com \emph{benchmarks} da literatura ou com soluções analíticas.
\item \emph{Capítulo 6: Conclusões e Trabalho Futuros.} Neste último capítulo são feitas as observações principais a respeito dos objetivos atingidos neste trabalho quando comparado com as metas estabelecidas. Finalmente, são apresentadas algumas possibilidades de trabalhos futuros baseados no que foi discutido ao longo desta dissertação.
\item \emph{Apêndice 1: Delfine - Manual do Usuário.} Este apêndice tem um enfoque bastante prático e seu objetivo é servir como um tutorial para o leitor interessado em utilizar as ferramentas desenvolvidas neste trabalho. Todos os passos, desde a obtenção do código através da internet até o uso do mesmo, passando pela instalação e configuração de pacotes adicionais, são discutidos com base em um exemplo simples usado como orientação.
%\item \emph{Anexo 2: Delfine - Trechos de Código Selecionados.} Compilação de trechos de códigos escritos para este trabalho e discutidos especialmente no capítulo \ref{ch:implementacao} são apresentados ao final da dissertação por um questão de clareza e organização.
\end{itemize}




