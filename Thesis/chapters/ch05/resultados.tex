\chapter{Resultados}
\label{ch:resultados}

Neste capítulo serão apresentados exemplos e resultados obtidos utilizando a metodologia e o programa computacional descritos nos capítulos anteriores.

\section{Problemas Elípticos}
\label{sc:elipticos}
Esta seção tem por objetivo avaliar os métodos utilizados para a resolução da equação da pressão em meios porosos, a qual para o estado estacionário pode ser considerada uma típica equação elíptica. Devido a essa característica, a metodologia utilizada pode ser analisada utilizando-se de problemas modelos que compartilham das mesmas propriedades matemáticas. Uma particularidade comum aos problemas regidos por equações elípticas é que todo o domínio de interesse $\Omega$ é afetado por qualquer mudança no valor da variável em um ponto qualquer no interior de $\Omega$, ou em sua fronteira $\Gamma$ \citep{Fortuna2000}. Isto significa que uma perturbação em um ponto irá ter influência sobre todo o domínio, sendo que a mesma diminui com o aumento da distância em relação ao ponto originador de tal perturbação. Sendo assim, tais problemas tendem em geral a apresentar soluções suaves ao longo do domínio. Além da equação de pressão, outros exemplos de aplicação deste tipo de equação são o cálculo do potencial elétrico, da difusão de calor em uma chapa metálica e de escoamentos incompressíveis, invíscidos e irrotacionais (também conhecidos como escoamentos potenciais).

A equação normalmente utilizada como modelo para testar metodologias de resolução de equações elípticas pode ser descrita como:
\begin{equation} \label{eq:poi}
\nabla(\mathbi{K} \nabla u) = f
\end{equation}

Em coordenadas cartesianas e considerando um coeficiente anisotrópico e variável no espaço $\mathbi{K}(x,y,z)$, esta equação pode ser representada por:
\begin{equation} \label{eq:poicart}
\frac{\partial }{\partial x}\left(\mathbi{K}\frac{\partial u}{\partial x}\right) + \frac{\partial }{\partial y}\left(\mathbi{K}\frac{\partial u}{\partial y}\right) + \frac{\partial }{\partial z}\left(\mathbi{K}\frac{\partial u}{\partial z}\right) = f(x,y,z)
\end{equation}

Nas seções seguintes, iremos resolver equações do tipo (\ref{eq:poicart}) considerando diversas possibilidades para o coeficiente $\mathbi{K}$ de modo a demonstrar a flexibilidade da metodologia utilizada para lidar com meios homogêneos, heterogêneos, iso- e anisotrópicos. Vários parâmetros de interesse serão avaliados a partir dos resultados obtidos, entre eles:
\begin{itemize}
\item Erro da solução numérica quando comparada com a solução analítica, a qual para problemas simples é facilmente encontrada.
\item Taxas de convergências para uma sequência de malhas sucessivamente refinadas.
\item Evolução do resíduo para diferentes estratégias de resolução do sistema de equações lineares.
\end{itemize}

\subsection{Meio Homogêneo e Isotrópico}
\label{sc:homogeneoiso}
Este primeiro exemplo foi originalmente proposto em \citep{Chen2006}, sendo resolvido utilizando dois métodos diferentes, o CVFA (\emph{Control Volume Function Approximation}) e o CVFE (\emph{Control Volume Finite Element}). Este problema também foi explorado em \citep{Silva2008} utilizando duas variações do Método dos Volumes Finitos baseado em Arestas (EBFV1 e EBFV2). Este exemplo é um problema de valor de contorno que pode ser representado do modo a seguir:
\begin{equation} \label{eq:homogeneoiso}
\nabla(\mathbi{K} \nabla u) = 2 \pi^{2} \cos (\pi x) \cos(\pi y) \quad \textrm{em  } \quad \Omega = \{(x,y) \ \vert \ 0 < x < 1 \textrm{ e } 0 < y < 1\}
\end{equation}
onde $\mathbi{K}$ é uma matriz simétrica e diagonal representada por:
\begin{equation} \label{eq:coeffhomoiso}
\mathbi{K} = \left( \begin{array}{cc}
1 & 0 \\
0 & 1
\end{array} \right)
\end{equation}

Este problema apresenta condições de contorno periódicas nas fronteiras inferior e superior, já as fronteiras laterais estão sujeitas a uma condição de fluxo zero. Matematicamente tais condições de contorno podem ser definidas do seguinte modo:
\begin{equation} \label{eq:bchomoiso}
\left. \begin{array}{lll}
u = \cos(\pi x)  & \textrm{para } 0<x<1  \textrm{ e } y=0} \\
u = -\cos(\pi x) & \textrm{para } 0<x<1 \textrm{ e } y=1}  \\
\nabla u \cdot \vec{n} = 0 & \textrm{para } 0<y<1 \textrm{ e } x=0,1}
\end{array} \right.
\end{equation}

Resolvemos o problema elíptico descrito utilizando a formulação detalhada no capítulo \ref{ch:form_num}, considerando diferentes malhas estruturadas sucessivamente refinadas e formadas por elementos triangulares de 1ª e 2ª ordem. O uso de malhas estruturadas se deu apenas para fins de comparação de erros e obtenção de ordens de convergência, já que a metodologia utilizada é perfeitamente capaz de lidar com malhas não-estruturadas bi- e tridimensionais. Para avaliação da acurácia do método utilizado, os resultados foram comparados com a solução analítica deste problema, a qual é representada pela função $u(x,y) = \cos(\pi x)\cos(\pi y)$. A Fig. \ref{fig:HomogeneoIsotropico_N=64} mostra o campo escalar $u$ obtido para a malha de 64x64 elementos triangulares lineares, a qual já permite obter uma excelente concordância com a solução analítica.

\begin{figure}
\centering
\includegraphics[width=0.5\textwidth]{chapters/ch05/HomogeneoIsotropico_N=64}
\caption[Caso homogêneo e isotrópico. Campo escalar para malha 64x64]{Campo escalar obtido utilizando o MEF com malha de 64x64 discretizada por triângulos lineares.}
\label{fig:HomogeneoIsotropico_N=64}
\end{figure}

Para uma sequência de malhas formadas por triângulos lineares, se espera uma taxa de convergência de segunda ordem, enquanto para uma sequência formada por triângulos quadráticos espera-se uma convergência de terceira ordem \citep{Hughes2000}. De modo a verificar o comportamento do método utilizado, resolvemos o problema proposto utilizando elementos de 1ª (Tabela \ref{tab:homoisolinear}) e 2ª ordem (Tabela \ref{tab:homoisoquad}), comparando entre si os resultados obtidos e também com outros disponíveis na literatura para elementos lineares utilizando outros tipos de formulação (Tabelas \ref{tab:homoisoCVFA} e \ref{tab:homoisoEBFV1}) \citep{Chen2006,Silva2008}. De um modo geral, as taxas de convergências obtidas se aproximaram bastante das taxas teóricas tanto para o caso de elementos triangulares lineares quanto quadráticos. A comparação com os resultados da literatura ficam um pouco prejudicadas por terem os erros sido calculados através de normas diferentes (norma do máximo neste trabalho, e RMS na literatura citada). Porém, é possível observar um comportamento coerente do erro obtido, pois com elementos quadráticos foram obtidos erros consideravelmente menores do que com os métodos de segunda ordem CVFA e EBFV1. Por outro lado, ao utilizar-se elementos lineares foram obtidos erros maiores porém na mesma ordem de grandeza daqueles obtidos na literatura.

\begin{table}
\caption[Erro e taxa de convergência para problema homogêneo e isotrópico]{Erro e taxa de convergência obtidos neste trabalho para a solução da equação elíptica em meio homogêneo e isotrópico.} 
\centering
\subtable[Triângulo Linear]{
	\begin{tabular}{|c|c|c|}
	\hline N & \vert\vert E_{max}\vert\vert & q_{max} \\
	\hline
	\hline 8 & 2.5e-02 & --- \\ 
	\hline 16 & 6.4e-03 & 1.97 \\ 
	\hline 32 & 1.6e-03 & 1.99 \\ 
	\hline 64 & 4.0e-04 & 1.99 \\ 
	\hline 128 & 1.0e-04 & 2.00 \\ 
	\hline 256 & 2.5e-05 & 1.99 \\ 
	\hline 
	\end{tabular}
	\label {tab:homoisolinear}
}
\qquad\qquad
\subtable[Triângulo Quadrático]{
	\begin{tabular}{|c|c|c|}
	\hline N & \vert\vert E_{max}\vert\vert & q_{max} \\
	\hline
	\hline 8 & 6.4e-04 & --- \\ 
	\hline 16 & 8.7e-05 & 2.87 \\ 
	\hline 32 & 1.1e-05 & 2.94 \\ 
	\hline 64 & 1.4e-06 & 2.98 \\ 
	\hline 128 & 1.8e-07 & 2.98 \\ 
	\hline 256 & 2.2e-08 & 3.00 \\ 
	\hline 
	\end{tabular}
	\label {tab:homoisoquad}
}
\end{table}

\begin{table}
\caption[Erro e taxa de convergência para problema homogêneo e isotrópico - literatura]{Erro e taxa de convergência obtidos em \cite{Chen2006} e \cite{Silva2008} para a solução da equação elíptica em meio homogêneo e isotrópico.} 
\centering
\subtable[CVFA\citep{Chen2006}]{
	\begin{tabular}{|c|c|c|}
	\hline N & \vert\vert E_{rms}\vert\vert & q_{rms} \\
	\hline
	\hline 8 & 1.2e-02 & --- \\ 
	\hline 16 & 3.0e-03 & 2.02 \\ 
	\hline 32 & 7.4e-03 & 2.01 \\ 
	\hline 64 & 1.8e-04 & 2.00 \\ 
	\hline 
	\end{tabular}
	\label {tab:homoisoCVFA}
}
\qquad\qquad
\subtable[EBFV1\citep{Silva2008}]{
	\begin{tabular}{|c|c|c|}
	\hline N & \vert\vert E_{rms}\vert\vert & q_{rms} \\
	\hline
	\hline 8 & 6.9-03 & --- \\ 
	\hline 16 & 1.4e-03 & 2.29 \\ 
	\hline 32 & 3.2e-04 & 2.13 \\ 
	\hline 64 & 7.7e-05 & 2.06 \\ 
	\hline 
	\end{tabular}
	\label {tab:homoisoEBFV1}
}
\end{table}

Para a resolução do sistema de equações lineares provenientes da discretização do problema foram testadas três diferentes alternativas:
\begin{itemize}
\item Métodos dos Gradientes Conjugados (CG) aplicado isoladamente.
\item Método do Multigrid Algébrico (AMG) aplicado isoladamente.
\item Multigrid Algébrico aplicado como pré-condicionador para o método dos Gradientes Conjugados (AMG+CG).
\end{itemize}

Para a realização dos testes, foi utilizada uma malha de 32x32 elementos triangulares de 1ª ordem. Para todos os casos foi considerado como critério de parada uma tolerância $\epsilon = 10^{-10}$, com um número máximo de 200 iterações. Para os casos nos quais o método AMG foi utilizado como forma de acelerar a convergência, considerou-se ciclos do tipo $V$ em uma hierarquia de 4 ``malhas'' sucessivamente mais grosseiras . É importante apenas lembrar que o método AMG não depende de malhas grosseiras propriamente ditas, apenas das matrizes que representam o sistema de equações, sendo tais matrizes manipuladas algebricamente de modo a se obter os níveis mais grosseiros \citep{Trottenberg2001}. 

Como pode ser observado na Fig. \ref{fig:residualHomogeneoIsotropico_N=32}, os esquemas utilizando o método multigrid (AMG e AMG+CG) apresentaram resultados bastante superiores em relação ao método CG, o qual utiliza apenas um único sistema de equações lineares (ou seja, uma única ``malha''). Enquanto o método AMG+CG reduz o resíduo em aproximadamente uma ordem de grandeza por iteração, o método CG necessita de aproximadamente 10 vezes mais iterações para reduzir o resíduo na mesma proporção. É interessante comparar também os resultados obtidos ao utilizar-se o AMG isoladamente e ao usá-lo como um pré-condicionador para o método dos Gradientes Conjugados. Percebe-se que nas primeiras iterações os dois métodos apresentam fatores de convergência para o resíduo praticamente idênticos, porém a medida que se prossegue com as iterações, o AMG usado isoladamente tende a apresentar uma piora na taxa de convergência, enquanto o método que utiliza a combinação AMG+CG mantém o excelente fator de convergência obtido inicialmente.

Isto se deve a um aspecto bastante observado na literatura \citep{Trottenberg2001,Oosterlee1998,Mavriplis2001} no qual um único ou poucos autovalores da matriz representante do operador de iteração Multigrid estão com um valor muito acima daquele obtido para os demais autovalores. Sendo que o autovalor máximo (também chamado de raio espectral) do operador de iteração indica em última análise o fator de convergência assimptótica para o problema \citep{Briggs2000}, limitando portanto a taxa de convergência possível de ser obtida. Um modo de contornar tal problema é justamento utilizar algum dos métodos de subespaço de Krylov, como é o caso do método CG, os quais têm a característica de em poucas iterações amortecer os autovetores relacionados aos poucos autovalores elevados \citep{Trottenberg2001}.

\begin{figure}
\centering
\includegraphics[width=0.7\textwidth]{chapters/ch05/residualHomogeneoIsotropico_N=32}
\caption[Caso homogêneo e isotrópico. Comparação da evolução dos resíduos para malha 32x32]{Caso homogêneo e isotrópico. Comparação da evolução dos resíduos para malha 32x32 discretizada por triângulos lineares.}
\label{fig:residualHomogeneoIsotropico_N=32}
\end{figure}

\subsection{Meio Homogêneo e Anisotrópico}
\label{sc:homogeneoaniso}
Este problema foi originalmente proposto em \cite{Crumpton1995}, onde foi resolvido utilizando um método de volumes finitos centrado na célula (FCFV), tendo também sido estudado em \cite{Carvalho2005} e \cite{Silva2008} utilizando o já mencionado método dos volumes finitos baseado em arestas (EBFV).

Neste segundo exemplo, buscamos explorar a flexibilidade da metodologia utilizada, a qual permite considerar tensores diagonais ou cheios para representar o parâmetro $\mathbi{K}$. O problema proposto pode ser descrito através da Eq. (\ref{eq:homogeneoaniso}) aplicada em um domínio $\Omega = (0,1)x(0,1)$.
\begin{equation} \label{eq:homogeneoaniso}
\nabla(\mathbi{K} \nabla u) = -2(1 + x^2 + xy + y^2)e^{xy}
\end{equation}
onde $\mathbi{K}$ é uma matriz simétrica e não-diagonal representada por:
\begin{equation} \label{eq:coeffhomoaniso}
\mathbi{K} = \left( \begin{array}{cc}
2 & 1 \\
1 & 2
\end{array} \right)
\end{equation}

A descrição deste problema está completa ao definir-se a condição de fronteira em todo o contorno $\Gamma$ como $u(x,y)=e^{xy}$.

Na Fig. \ref{fig:HomogeneoAnisotropico_N=64} pode ser observado o campo escalar para a variável $u$, considerando uma discretização do domínio $\Omega$ com uma malha de 64x64 elementos triangulares de 1ª ordem.

\begin{figure}
\centering
\includegraphics[width=0.5\textwidth]{chapters/ch05/HomogeneoAnisotropico_N=64}
\caption[Caso homogêneo e anisotrópico. Campo escalar para malha 64x64]{Caso homogêneo e anisotrópico. Campo escalar obtido utilizando o MEF com malha de 64x64 discretizada por triângulos lineares.}
\label{fig:HomogeneoAnisotropico_N=64}
\end{figure}

De modo a comparar os resultados obtidos com aqueles da literatura, calculamos o erro segundo a norma do máximo e as taxas de convergências para o mesmo considerando uma sequência de malhas sucessivamente refinadas (ver Tabela \ref{tab:homoanisolinear}). Tais resultados foram comparados com aqueles obtidos tanto pelo FCFV quanto pelo EBFV (ver Tabelas \ref{tab:homoanisocrump} e \ref{tab:homoanisocarvalho}).

\begin{table}
\caption[Erro e taxa de convergência para problema homogêneo e anisotrópico]{Erro e taxa de convergência obtidos neste trabalho para a solução da equação elíptica em meio homogêneo e anisotrópico.} 
\centering
\subtable[Triângulo Linear]{
	\begin{tabular}{|c|c|c|}
	\hline N & \vert\vert E_{max}\vert\vert & q_{max} \\
	\hline
	\hline 8 & 2.1e-03 & --- \\ 
	\hline 16 & 5.3e-04 & 2.01 \\ 
	\hline 32 & 1.3e-04 & 2.00 \\ 
	\hline 64 & 3.3e-05 & 1.99 \\ 
	\hline 128 & 8.3e-06 & 2.00 \\ 
	\hline 256 & 2.1e-06 & 2.00 \\ 
	\hline 
	\end{tabular}
	\label {tab:homoanisolinear}
}
\end{table}

\begin{table}
\caption[Erro e taxa de convergência obtidos na literatura para problema homogêneo e anisotrópico]{Erro e taxa de convergência obtidos em \cite{Crumpton1995} e \cite{Carvalho2005} para a solução da equação elíptica em meio homogêneo e anisotrópico.} 
\centering
\subtable[FCFV\citep{Crumpton1995}]{
	\begin{tabular}{|c|c|c|}
	\hline N & \vert\vert E_{rms}\vert\vert & q_{rms} \\
	\hline
	\hline 8 & 1.2e-03 & --- \\ 
	\hline 16 & 2.9e-04 & 2.00 \\ 
	\hline 32 & 7.3-05 & 1.99 \\ 
	\hline 64 & 1.8e-05 & 1.99 \\ 
	\hline 
	\end{tabular}
	\label {tab:homoanisocrump}
}
\qquad\qquad
\subtable[EBFV\citep{Carvalho2005}]{
	\begin{tabular}{|c|c|c|}
	\hline N & \vert\vert E_{max}\vert\vert & q_{max} \\
	\hline
	\hline 8 & 3.0e-03 & --- \\ 
	\hline 16 & 1.0e-03 & 1.58 \\ 
	\hline 32 & 3.4-04 & 1.80 \\ 
	\hline 64 & 8.9-05 & 1.94 \\
	\hline 
	\end{tabular}
	\label {tab:homoanisocarvalho}
}
\end{table}

Pode-se observar pelos resultados obtidos que novamente o MEF se comportou como esperado, apresentado uma taxa de convergência de ordem 2 para os elementos lineares. Os valores absolutos do erro na norma do máximo se comparam de maneira ligeiramente favorável àqueles apresentados em \cite{Carvalho2005}.

Assim como para o primeiro exemplo, também neste fizemos um estudo a respeito do desempenho de diferentes métodos iterativos para a resolução do sistema de equações lineares provenientes da discretização do problema. Cinco diferentes alternativas foram testadas:
\begin{itemize}
\item Métodos dos Gradientes Conjugados (CG) aplicado isoladamente.
\item Métodos do Resíduo Mínimo Generalizado (GMRES) aplicado isoladamente.
\item Método do Multigrid Algébrico (AMG) aplicado isoladamente.
\item Multigrid Algébrico aplicado como pré-condicionador para o método dos Gradientes Conjugados (AMG+CG).
\item Multigrid Algébrico aplicado como pré-condicionador para o método do Resíduo Mínimo Generalizado (AMG+GMRES).
\end{itemize}

É importante mencionar que o método GMRES é normalmente utilizado para problemas envolvendo matrizes não-simétricas \citep{Saad2003}, tendo sido avaliado apenas para verificar a flexibilidade do resolvedor de sistemas de equações lineares, já que a discretização deste problema resulta em uma matriz auto-adjunta (e portanto simétrica se considerarmos apenas termos reais).

\begin{figure}
\centering
\includegraphics[width=0.7\textwidth]{chapters/ch05/residualHomoAniso_N=64}
\caption[Caso homogêneo e anisotrópico. Comparação da evolução dos resíduos para malha 64x64]{Caso homogêneo e anisotrópico. Comparação da evolução dos resíduos para malha 64x64 discretizada por triângulos lineares.}
\label{fig:residualHomogeneoAnisotropico_N=64}
\end{figure}

Para a realização dos testes, foi utilizada uma malha de 64x64 elementos triangulares de 1ª ordem. Para todos os casos foi considerada como critério de parada uma tolerância $\epsilon = 10^{-10}$, com um número máximo de 200 iterações. Em todos os casos nos quais o método AMG foi utilizado como forma de acelerar a convergência, considerou-se ciclos do tipo $V$ em uma hierarquia de 4 ``malhas'' sucessivamente mais grosseiras. Um gráfico mostrando a evolução do resíduo normalizado para todos os métodos testados pode ser observado na Fig. \ref{fig:residualHomogeneoAnisotropico_N=64}, onde fica claro novamente a grande superioridade dos métodos que utilizam aceleração de convergência via multigrid em comparação com os outros métodos. É interessante notar também que para este exemplo os métodos CG e GMRES tiveram desempenhos bastante próximos, tanto isoladamente quanto em conjunto com o AMG enquanto pré-condicionador.



\subsection{Meio Heterogêneo e Anisotrópico}
\label{sc:heterogeneoaniso}
Neste exemplo foi considerado um meio heterogêneo e anisotrópico. Este caso foi proposto em \citep{Crumpton1995}, tendo sido também analisado em vários outros trabalhos \citep{Hyman1997, Carvalho2005, Silva2008}. O domínio $\Omega$ é um quadrado $[-1,1]x[-1,1]$ com condições de contornos de Dirichlet dadas pela solução exata. O parâmetro $\mathbi{K}$ é definido por:

\begin{equation} \label{eq:coeffheteroaniso}
\mathbi{K} = \left\{ \begin{array}{cc}
  \phantom{\psi}\left( \begin{array}{cc}
1 & 0 \\
0 & 1
\end{array} \right) & \textrm{se $x \leq 0$}\\
  \psi\left( \begin{array}{ll}
2 & 1 \\
1 & 2
\end{array} \right) & \textrm{se $x > 0$}
  \end{array} \right.
\end{equation}
onde o fator $\psi$%
\nomenclature[a1psi]{$\psi$}{Fator de descontinuidade no domínio}
é um parâmetro utilizado para definir a intensidade de descontinuidade em $x = 0$.

A solução analítica (e condição de Dirichlet para os contornos) é dada por:

\begin{equation} \label{eq:heteroaniso}
u(x,y) = \left\{ \begin{array}{ll}
  [2\sin(y)+\cos(y)]\psi x + \sin(y) & \textrm{se $x \leq 0$}\\
  \psi\exp(x)\sin(y) & \textrm{se $x > 0$}
  \end{array} \right.
\end{equation}
 
Por fim, podemos definir o também descontínuo termo fonte como:

\begin{equation} \label{eq:bcheteroaniso}
f(x,y) = \left\{ \begin{array}{ll}
  [-2\sin(y)-\cos(y)]\psi x - \sin(y) & \textrm{se $x \leq 0$}\\
  2\psi\exp(x)\cos(y) & \textrm{se $x > 0$}
  \end{array} \right.
\end{equation}

Para a resolução deste problema e obtenção de taxas de convergência, consideramos uma sequência de malhas sucessivamente refinadas com dimensões aproximadas de $(8x8), (16x16), (32x32), (64x64)$ e $(128x128)$.
A malha não-estruturada utilizada com aproximadamente $(8x8)$ elementos e a divisão dos subdomínios em $x=0$ pode ser observada na Fig. \ref{fig:HeterogeneoAnisoMaterials_N=8}.

\begin{figure}
\centering
\includegraphics[width=0.6\textwidth]{chapters/ch05/HeterogeneoAnisoMaterials_N=8}
\caption[Caso heterogêneo e anisotrópico. Malha não-estruturada e heterogeneidade]{Domínio utilizado e malha não-estruturada com aproximadamente $(8x8)$ elementos e heterogeneidade em $x=0$.}
\label{fig:HeterogeneoAnisoMaterials_N=8}
\end{figure}

Pode ser observado na Fig. \ref{fig:HeterogeneoAnisoContour_N=64} o efeito da descontinuidade na linha $x=0$, efeito este que se torna mais pronunciado ao aumentarmos o valor do parâmetro $\psi$. Os valores para os erros da solução numérica quando comparada com a analítica para as normas do máximo e $L2$ são apresentados na Tabela \ref{tab:heteroiso}, onde pode ser visto que um aumento na descontinuidade do tensor $\mathbi{K}$ para os diferentes sub-domínios causa um aumento nos valores absolutos dos erros obtidos.

\begin{figure}
\centering
\subfigure[$\psi=1$]{
\includegraphics[width=0.45\textwidth]{chapters/ch05/HeterogeneoAnisoContour_N=64_alpha=1}
}
\quad
\subfigure[$\psi=10$]{
\includegraphics[width=0.45\textwidth]{chapters/ch05/HeterogeneoAnisoContour_N=64_alpha=10}
}
\quad
\subfigure[$\psi=100$]{
\includegraphics[width=0.45\textwidth]{chapters/ch05/HeterogeneoAnisoContour_N=64_alpha=100}
}
\quad
\subfigure[$\psi=1000$]{
\includegraphics[width=0.45\textwidth]{chapters/ch05/HeterogeneoAnisoContour_N=64_alpha=1000}
}
\caption[Caso heterogêneo e anisotrópico. Campo escalar para malha de 64x64.]{Campo escalar obtido para diferentes fatores de descontinuidade $\psi$ utilizando o MEF com malha de 64x64 discretizada por triângulos lineares.}
\label{fig:HeterogeneoAnisoContour_N=64}
\end{figure}

\begin{table}
\caption[Erro e taxa de convergência para problema heterogêneo e anisotrópico]{Erro e taxa de convergência obtidos neste trabalho para a solução da equação elíptica em meio heterogêneo e anisotrópico.} 
\centering
\subtable[$\psi=1$]{
	\begin{tabular}{|c|c|c|c|c|}
	\hline N & \vert\vert E_{max}\vert\vert & q_{max} & \vert\vert E_{L2}\vert\vert & q_{L2} \\
	\hline
	\hline 8 & 5.4e-02 & --- & 4.5e-02 & --- \\ 
	\hline 16 & 2.7e-02 & 0.99 & 2.0e-02 & 1.1 \\ 
	\hline 32 & 1.3e-02 & 1.02 & 9.8e-03 & 1.05 \\ 
	\hline 64 & 6.6e-03 & 1.02 & 4.8e-03 & 1.02 \\ 
	\hline 128 & 3.2e-03 & 1.02 & 2.4e-03 & 1.00 \\ 
	\hline 
	\end{tabular}
	\label{tab:heteroiso1}
}
\qquad\qquad
\subtable[$\psi=10$]{
	\begin{tabular}{|c|c|c|c|c|}
	\hline N & \vert\vert E_{max}\vert\vert & q_{max} & \vert\vert E_{L2}\vert\vert & q_{L2} \\
	\hline
	\hline 8 & 9.2e-02 & --- & 1.8e-01 & --- \\ 
	\hline 16 & 3.8e-02 & 1.3 & 5.2e-02 & 1.78 \\ 
	\hline 32 & 1.9e-02 & 1.02 & 1.8e-02 & 1.52 \\ 
	\hline 64 & 9.2e-03 & 1.02 & 7.7e-03 & 1.24 \\ 
	\hline 128 & 4.6e-03 & 1.00 & 3.6e-03 & 1.08 \\ 
	\hline 
	\end{tabular}
	\label{tab:heteroiso10}
}
\qquad\qquad
\subtable[$\psi=100$]{
	\begin{tabular}{|c|c|c|c|c|}
	\hline N & \vert\vert E_{max}\vert\vert & q_{max} & \vert\vert E_{L2}\vert\vert & q_{L2} \\
	\hline
	\hline 8 & 8.6e-01 & --- & 1.7e-00 & --- \\ 
	\hline 16 & 2.9e-01 & 1.59 & 4.3e-01 & 1.98 \\ 
	\hline 32 & 8.8e-02 & 1.70 & 1.1e-01 & 1.98 \\ 
	\hline 64 & 2.5e-02 & 1.79 & 2.8e-02 & 1.94 \\ 
	\hline 128 & 7.2e-03 & 1.81 & 7.9e-03 & 1.84 \\ 
	\hline 
	\end{tabular}
	\label{tab:heteroiso1000}
}
\qquad\qquad
\subtable[$\psi=1000$]{
	\begin{tabular}{|c|c|c|c|c|}
	\hline N & \vert\vert E_{max}\vert\vert & q_{max} & \vert\vert E_{L2}\vert\vert & q_{L2} \\
	\hline
	\hline 8 & 8.8e-00 & --- & 1.7e+01 & --- \\ 
	\hline 16 & 2.9e-00 & 1.58 & 4.3e-00 & 1.98 \\ 
	\hline 32 & 9.2e-01 & 1.68 & 1.1e-00 & 2.0 \\ 
	\hline 64 & 2.7e-01 & 1.74 & 2.7e-01 & 1.99 \\ 
	\hline 128 & 7.9e-02 & 1.79 & 6.8e-02 & 1.99 \\ 
	\hline 
	\end{tabular}
	\label{tab:heteroiso1000}
}
\label{tab:heteroiso}
\end{table}

Um fato interessante que pode ser constatado a partir dos valores obtidos para os erros da solução numérica obtida é que os mesmos apresentam uma taxa de convergência na norma $L2$ em torno de 1 para $\psi = 1$ e $10$, sendo que esta taxa se aproxima de 2 quando aumentamos o fator de descontinuidade ($\psi = 100$ e $1000$).
Ao compararmos tais resultados com a literatura \citep{Crumpton1995,Hyman1997,Carvalho2005,Silva2008} percebemos que os métodos apresentados nos referidos trabalhos que fazem uma avaliação local dos fluxos tendem a obter uma convergência de ordem 2, enquanto métodos que trabalham apenas com a variável nodal (neste caso, $u(x,y)$) apresentam ordem 1 para o erro, tanto na norma do máximo quanto para a $L2$.

Um aspecto a ser notado que pode contribuir para a compreensão deste comportamento é a distribuição do erro ao longo do domínio para diferentes valores de $\psi$. Na Fig. \ref{fig:HeterogeneoAnisoError_N=64} pode ser visto que o erro varia suavemente para $\psi = 1$ e $\psi = 10$, sendo que o mesmo está concentrado na região de descontinuidade em $x=0$. Já para $\psi = 100$ e $\psi = 1000$, o erro para a malha de $N \simeq 64$ apresenta modos de frequência muito mais alta, estando também concentrado em um dos lados do domínio.

Este comportamento pode ser explicado pelo fato de que para maiores valores de $\psi$ temos uma intensidade maior de descontinuidade para o mesmo tamanho de malha, o que pode ser visto como equivalente a manter o valor do coeficiente de descontinuidade e engrossar a malha, levando portanto os componentes do erro a se apresentarem como de mais alta frequência, independente da magnitude dos mesmos \citep{Trottenberg2001}.

\begin{figure}
\centering
\subfigure[$\psi=1$]{
\includegraphics[width=0.45\textwidth]{chapters/ch05/HeterogeneoAnisoError_N=64_alpha=1}
}
\quad
\subfigure[$\psi=10$]{
\includegraphics[width=0.45\textwidth]{chapters/ch05/HeterogeneoAnisoError_N=64_alpha=10}
}
\quad
\subfigure[$\psi=100$]{
\includegraphics[width=0.45\textwidth]{chapters/ch05/HeterogeneoAnisoError_N=64_alpha=100}
}
\quad
\subfigure[$\psi=1000$]{
\includegraphics[width=0.45\textwidth]{chapters/ch05/HeterogeneoAnisoError_N=64_alpha=1000}
}
\caption[Caso heterogêneo e anisotrópico. Erro obtido para malha 64x64.]{Caso heterogêneo e anisotrópico. Distribuição do erro obtido para malha com $N \simeq 64$ discretizada por triângulos lineares.}
\label{fig:HeterogeneoAnisoError_N=64}
\end{figure}

Para a resolução do sistema de equações lineares resultante da discretização foi novamente verificado o desempenho para diferentes tipos de métodos, mesmo sabendo de antemão que este problema é representado por uma matriz simétrica positiva-definida, sendo portanto um candidato natural a ser resolvido usando métodos do tipo gradiente conjugado, seja isoladamente ou com o multigrid algébrico como pré-condicionador.

Os resultados obtidos para a evolução dos resíduos podem ser verificados na Fig. \ref{fig:residualHeterogeneoAniso_N=64_alpha=1}, onde mais uma vez é constatada a superioridade dos métodos que utilizam multigrid, mesmo para este problema que apresenta sub-domínios com propriedades diferentes.

\begin{figure}
\centering
\includegraphics[width=0.7\textwidth]{chapters/ch05/residualHeterogeneoAniso_N=64_alpha=1}
\caption[Caso heterogêneo e anisotrópico. Comparação da evolução dos resíduos para malha 64x64.]{Caso heterogêneo e anisotrópico. Comparação da evolução dos resíduos para malha 64x64 discretizada por triângulos lineares e com $\psi = 1$.}
\label{fig:residualHeterogeneoAniso_N=64_alpha=1}
\end{figure}

\section{Problemas de Escoamentos Bifásicos em Meios Porosos}
\label{sc:escoabifasico}
%Ao se considerar também a equação de saturação, o problema do deslocamento de fluidos em meios porosos passa a ter também um componente %altamente hiperbólico.
\subsection{Buckley-Leverett 1-D}
\label{sc:bl1D}
Este exemplo trata do deslocamento imiscível de óleo por água em um meio poroso rígido unidimensional e homogêneo, onde foram desprezados os efeitos da gravidade e capilaridade (ver Fig. \ref{fig:bl1dmodel}). O modelo para representar este fenômeno foi proposto originalmente por \cite{Buckley1942} e sua representação matemática está descrita na seção \ref{sc:buckleyeq} deste trabalho. 

\begin{figure}
\centering
\includegraphics[width=0.7\textwidth]{chapters/ch05/figBL}
\caption{Representação de escoamento unidimensional imiscível de óleo por água (retirado de \cite{Hurtado2005}).}
\label{fig:bl1dmodel}
\end{figure}

Foi utilizado o modelo de Corey (descrito na seção \ref{sc:propriedades}) com coeficiente $n_{w} = n_{o} = 2$ para a dependência da permeabilidade relativa em relação à saturação. A saturação residual de água e óleo foi assumida como nula e a razão de viscosidade entre as fases como unitária. Para este exemplo consideramos um vetor velocidade $\mathbi{v}$ unitário e as seguintes condições iniciais e de contorno:
\begin{equation} \label{eq:buclevertconinibc}
\left. \begin{array}{lll}
S_{w}(x,0) = 0.0 \quad \textrm{em $\Omega$} \\
S_{w}(x,t) = 1.0 \quad \textrm{em $x=0$} \\
\end{array} \right.
\end{equation}

Devido às características essencialmente hiperbólicas deste problema, foi utilizado para sua solução o \ac{MEF} com estabilização via \ac{SUPG} e adição de viscosidade artificial para diminuir as oscilações. Na Fig. \ref{fig:bl1dfemsupg} são apresentadas as soluções analítica e numérica para um $t=0.3$ em domínio como comprimento unitário e considerando uma malha uniforme com 500 subdivisões. 

Como pode ser observado, na região de gradiente mais suave as soluções são praticamente coincidentes. Além disso, a posição do choque é corretamente capturada pela solução numérica. Entretanto, observa-se a existência de uma região de oscilação logo após o choque, mesmo ao se utilizar difusão artificial. Uma alternativa seria aumentar a quantidade de difusão adicionada, porém isto teria o efeito colateral de causar uma maior dispersão na região de choque, o que não é desejado. De um modo geral, consideramos os resultados satisfatórios, porém os mesmos são dependentes de termos para estabilização e captura de choque que contém parâmetros que devem ser calibrados para cada problema.

\begin{figure}
\centering
\includegraphics[width=0.7\textwidth]{chapters/ch05/BL1D}
\caption[Perfil de saturação para a resolução da equação de Buckley-Leverett]{Perfil de saturação para a resolução da equação de Buckley-Leverett com \ac{MEF} estabilizado via \ac{SUPG} e com operador de captura de choque.}
\label{fig:bl1dfemsupg}
\end{figure}

\subsection{1/4 de Cinco Poços Heterogêneo}
\label{sc:quarterfivespothetero}
Este último exemplo considera o escoamento bifásico imiscível óleo-água em um meio poroso heterogêneo e bidimensional. Este problema foi adaptado de \citep{Carvalho2005}, e consiste em um domínio $\Omega$ quadrilateral com uma região de baixa permeabilidade entre os poços injetor e produtor, os quais se encontram nas diagonais inferior esquerda e superior direita, respectivamente. A Fig \ref{fig:biphase2description} mostra uma descrição das principais características e condições de contorno deste problema.

A saturação inicial considerada foi $S_{w}(\mathbi{x},0) = 0.0$ em $\Omega$. Foi utilizado o modelo de Corey (descrito na seção \ref{sc:propriedades}) com coeficiente $n_{w} = n_{o} = 2$ para a dependência da permeabilidade relativa em relação à saturação. Tanto a porosidade $\phi$ quanto a viscosidade $\mu$ foram consideradas constantes e com valor unitário. As permeabilidades das regiões $1$ e $2$ de $\Omega$ são isotrópicas e podem ser representadas pelos tensores a seguir:
\begin{equation} \label{eq:permcincpocheter}
\mathbi{K} = \left\{ \begin{array}{cc}
  \left( \begin{array}{cc}
1 & 0 \\
0 & 1
\end{array} \right) & \textrm{se $\mathbi{K} = \mathbi{K}_{1}$}\\
  \left( \begin{array}{ll}
10^{-4} & 0 \\
0 & 10^{-4}
\end{array} \right) & \textrm{se $\mathbi{K} = \mathbi{K}_{2}$}
  \end{array} \right.
\end{equation}

Para a solução numérica deste problema utilizamos uma malha não-estruturada com 898 elementos triangulares de 1ª ordem. As variáveis pressão e velocidade foram obtidas através do \ac{MEFM} resolvido de modo implícito. A velocidade obtida foi utilizada para o acoplamento com a equação da saturação, a qual também foi discretizada utilizando o \ac{MEF} com estabilização via \ac{SUPG} e adição de difusão artifical nas regiões de maiores gradientes, cuja indicação é alcançada através de um termo de captura de choque. A parte hiperbólica também foi resolvida de maneira implícita resultando portanto em um esquema de avanço no tempo do tipo sequencial implícito. A saturação calculada é usada para atualizar as propriedades (apenas a permeabilidade relativa para este caso particular) utilizadas pela equação da pressão e velocidade.

\begin{figure}
\centering
\includegraphics[width=0.7\textwidth]{chapters/ch05/FiguraHeterogeneo2}
\caption[Descrição do problema de 1/4 de cinco poços]{Descrição do problema de 1/4 de cinco poços heterogêneo.}
\label{fig:biphase2description}
\end{figure}

Na Fig. \ref{fig:biphase2dextrude} é apresentado o campo de velocidade e o campo de saturação extrudado para o tempo $t = 0.3$ PVI(Porous Volume Injected). Pode ser observado nesta figura que a região de baixa permabilidade \emph{CONTINUAR DAQUI!!!}

\begin{figure}
\centering
\includegraphics[width=0.7\textwidth]{chapters/ch05/BIPHASE2D2}
\caption[Campo de velocidade e representação extrudada da saturação]{Campo de velocidade e representação extrudada da saturação para problema de 1/4 de cinco poços heterogêneo.}
\label{fig:biphase2dextrude}
\end{figure}

\begin{figure}
\centering
\includegraphics[width=1.0\textwidth]{chapters/ch05/BIPHASE2D_PlotOverLine}
\caption{Campo de saturação e representação do perfil ao longo da diagonal entre poços para problema de 1/4 de cinco poços heterogêneo.}
\label{fig:biphase2dprofile}
\end{figure}
